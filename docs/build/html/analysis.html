<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="The framework for models of thermodynamic equilibrium systems" href="index.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.03.04"/>
        <title>Analysis methods overview - The model framework analysis documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=935aa2abcc5c1da4283d1dc201fb1f0add16d23a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">The model framework analysis  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">The model framework analysis  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Analysis methods overview</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="analysis-methods-overview">
<h1>Analysis methods overview<a class="headerlink" href="#analysis-methods-overview" title="Permalink to this headline">#</a></h1>
<p>All analysis functions distributed with the base version of the <em>framework</em> can be found below.</p>
<section id="plot-system-data">
<h2>Plot system data<a class="headerlink" href="#plot-system-data" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.plot_model">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">plot_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_plot_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_plot_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.plot_model" title="Permalink to this definition">#</a></dt>
<dd><p>Itterates over the conditions associated with the provided system and
plots system.data and model solution (as a line) for each. If no solution
is determined, the current parameter values are tried instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>System object</em>) – System objects to plot the data and model prediction for.</p></li>
<li><p><strong>normalise</strong> (<em>boolean</em>) – Wheter to normalise all datapoint between 0-1.</p></li>
<li><p><strong>model_plot_min</strong> (<em>float</em>) – The minimum titrate concentration to plot</p></li>
<li><p><strong>model_plot_max</strong> (<em>float</em>) – The maximum titrate concentration to plot</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifies system.state</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>Matplotlib plot</em> – The plotted data</p></li>
<li><p><em>pandas.dataframe</em> – Dataframe containing the raw numbers plotted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="plotting-concentrations-graph">
<h2>Plotting concentrations graph<a class="headerlink" href="#plotting-concentrations-graph" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.plot_concentrations">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">plot_concentrations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentrations_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concentrations_stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.plot_concentrations" title="Permalink to this definition">#</a></dt>
<dd><p>Plot the concentrations of species in the system for a single condition.
The free titrate concentration is never plotted but is added to the
output file.</p>
<p>It is possible to select which species with the plot_species argument:
-‘all’: plots all species except for free titrate.
-‘components’: plot all species marked in the model as ‘independent’,
the components of the system.
-‘complexes’: plot all species marked in the model as ‘dependent’,
the complexes formed from the components.
-[‘R’, ‘S’, …]: a list of species to plot. Species need to be
defined in the model and lookup is case-sensitive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>System object</em>) – The system to analyse</p></li>
<li><p><strong>plot_species</strong> (<em>{'all'</em><em>, </em><em>'components'</em><em>, </em><em>'complexes'}</em><em> or </em><em>list of strings</em><em>, </em><em>optional</em>) – Which species to plot, see above for options. The default is ‘all’.</p></li>
<li><p><strong>concentrations_start</strong> (<em>float</em><em>, </em><em>optional</em>) – The lowest titrate concentration to plot. The default is equal to the
lowest concentration in the system.data.</p></li>
<li><p><strong>concentrations_stop</strong> (<em>float</em><em>, </em><em>optional</em>) – The highest titrate concentration to plot. The default is equal to the
highest concentration in the system.data.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the system has more than one condition associated.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifies system.state</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>matplotlib plot</em> – line plot showing the concentrations of the selected species as a
function of the total titrate concentration present.</p></li>
<li><p><em>pandas.dataframe</em> – Dataframe containing the numbers plotted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="alternative-range-of-initial-guess-values-solver">
<h2>Alternative range of initial guess values solver<a class="headerlink" href="#alternative-range-of-initial-guess-values-solver" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.range_solver">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">range_solver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_fit_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.range_solver" title="Permalink to this definition">#</a></dt>
<dd><p>Solve the system from a range of initial guess values, using a latin
hypercube approach to determine combinations. Displays all
determined values sorted by the squared error.</p>
<p>All parameters not included in range_fit_parameters are assumed to be
fixed at their current system values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>System object</em>) – The system to analyse</p></li>
<li><p><strong>range_fit_parameters</strong> (<em>Dictionary of string:tuple pairs</em>) – Each key represents a fit_parameter, the tuple should contain the
min and max expected values of that parameter.</p></li>
<li><p><strong>range_n</strong> (<em>int</em>) – The number of strata to create within each range. The default is 10.</p></li>
<li><p><strong>log_scale</strong> (<em>Boolean</em>) – Whether to use a log based scale instead of a linear scale to create
the strata. The default is True.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifies system parameters for the keys in range_fit_parameters
Modifies system.solution</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>result</strong> – All the determined parameter values with associated squared error.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dataframe</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="mean-squared-error-landscape">
<h2>Mean squared error landscape<a class="headerlink" href="#mean-squared-error-landscape" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.landscape">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">landscape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landscape_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.landscape" title="Permalink to this definition">#</a></dt>
<dd><p>Landscape post process selection tool. Will call the appropriate landscape
function based on the number of landscape_parameters.
If no landscape_parameters are given, the landscape function will try
to use the fit_parameters instead.
If more than two parameters are given only the first two will be plotted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>System object</em>) – The system to analyse</p></li>
<li><p><strong>landscape_parameters</strong> (<em>List of Strings</em>) – The parameters that should be varied in the landscape. If none are
given, instead the fit_parameters will be used.</p></li>
<li><p><strong>**kwargs</strong> (<em>Optional parameters</em>) – See specific landscape functions for details on the optional
parameters that can be suplied.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If len(landscape_parameters) &lt; 1 or
    if no landscape_parameters are given and there are no fit_parameters</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifies System.condition.state objects concentration</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>Matplotlib plot</em> – Appropriate landscape plot for the number of parameters.</p></li>
<li><p><em>Pandas dataframe</em> – Contains the raw values used in the plot</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
<section id="d-landscape">
<h3>1D landscape<a class="headerlink" href="#d-landscape" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.landscape_1d">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">landscape_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landscape_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landscape_1_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.landscape_1d" title="Permalink to this definition">#</a></dt>
<dd><p>Plot curve of MSE values based on variation in a single fit parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>System object</em>) – The system to plot parameter fits for.</p></li>
<li><p><strong>landscape_parameters</strong> (<em>List of strings</em>) – Note that a list is expected here. This is the parameter that will be
plotted. If more than one is given, only the first one is used.</p></li>
<li><p><strong>landscape_1_range</strong> (<em>1darray like</em><em>, </em><em>optional</em>) – Range of values to fit for the parameter. Use of np.geomspace is
recommended. If none are given the landscape parameter current value
times 0.01 and 100 are used as min and max value respectively.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Matplotlib plot</em> – Line plot of the MSE values for the range of parameter values.</p></li>
<li><p><em>pandas.dataframe</em> – Dataframe containing the numbers plotted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="id1">
<h3>2D landscape<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.landscape_2d">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">landscape_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landscape_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landscape_1_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landscape_2_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.landscape_2d" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a landschap of MSE values based on 2 fit parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>System object</em>) – The system to plot parameter fits for.</p></li>
<li><p><strong>landscape_parameters</strong> (<em>List of strings</em>) – The parameters that will be changed. If more than two are given, the
others are ignored.</p></li>
<li><p><strong>landscape_1_range</strong> (<em>1darray like</em><em>, </em><em>optional</em>) – Range of values to fit for the first parameter. Use of np.geomspace is
recommended. If none are given the landscape parameter current value
times 0.01 and 100 are used as min and max value respectively.</p></li>
<li><p><strong>landscape_2_range</strong> (<em>1darray like</em><em>, </em><em>optional</em>) – Range of values to fit for the second parameter. Use of np.geomspace is
recommended. If none are given the landscape parameter current value
times 0.01 and 100 are used as min and max value respectively.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Matplotlib plot</em> – 2D plot showing the MSE values for the range of parameter values as
contour plot.</p></li>
<li><p><em>pandas.dataframe</em> – Dataframe containing the raw numbers plotted.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if len(landscape_parameters) &lt; 2</p>
</dd>
</dl>
</dd></dl>
</section>
</section>
<section id="parameter-confidence-intervals">
<h2>Parameter confidence intervals<a class="headerlink" href="#parameter-confidence-intervals" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.confidence_interval">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">confidence_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bootstrap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_acceleration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.confidence_interval" title="Permalink to this definition">#</a></dt>
<dd><p>Determines a confidence interval for the parameters based on the
given approach. Currently only the bootstrap method is supported.</p>
<p>The bootstrap method is based on random draw, so a large number of
repeats is recommended to get accurate results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>System object</em>) – The system to perform the analysis on.</p></li>
<li><p><strong>confidence_method</strong> (<em>string</em><em>, </em><em>optional</em>) – The method to use to determine the interval.
The default is ‘bootstrap’.</p></li>
<li><p><strong>confidence_repeats</strong> (<em>integer</em><em>, </em><em>optional</em>) – The number of bootstrap sets to generate. A 1000 samples will
result in reasonable predictions in most cases. The default is 10
to give an indication of the total duration required.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifies system.state</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>result</strong> – Dataframe containing the determined point estimates for all generated
samples.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Pandas dataframe</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="parameter-sensitivity-analysis">
<h2>Parameter sensitivity analysis<a class="headerlink" href="#parameter-sensitivity-analysis" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.parameter_sensitivity">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">parameter_sensitivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_perturbation=0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_state='current'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_parameters=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensitivity_m_function=&lt;function</span> <span class="pre">_squared_error_m_function&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.parameter_sensitivity" title="Permalink to this definition">#</a></dt>
<dd><p>Performs local parameter sensitivity analysis on the system.</p>
<p>The parameters that are tested should be system constants. This means that
the parameter has the same value across all associated conditions.</p>
<p>This method is based on the description in van Riel, BRIEFINGS IN
BIOINFORMATICS Vol 7 (2006).
The M(y) value is the model output value to track upon change in parameter
value y. By default M is defined as the squared error of the model
compared to the measurement data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>System object</em>) – The system to analyse</p></li>
<li><p><strong>sensitivity_perturbation</strong> (<em>float</em><em>, </em><em>optional</em>) – The change in parameter value as a fraction increase. Negative values
will result in a decrease. The default is 0.5, a 50% increase.</p></li>
<li><p><strong>sensitivity_state</strong> (<em>{'solution'</em><em>, </em><em>'current'}</em><em>, </em><em>optional</em>) – Whether to use the current parameter values or the values determined
during system.solve. The default is ‘solution’, the solution values.</p></li>
<li><p><strong>sensitivity_parameters</strong> (<em>list of strings</em>) – List of parameters to test for sensitivity. By default the
fit_parameters are used as sensitivity_parameters</p></li>
<li><p><strong>sensitivity_m_function</strong> (<em>python function</em><em>, </em><em>optional</em>) – The function to use to determine the M value, see above. By default
the system.error_function is used. The function should take only a
single argument ‘system’.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifies system.state</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If any of the sensitivity_parameters is not a system constant, see
    above.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Matplot plot</em> – Barplot showing the sensitivities of the different parameters.</p></li>
<li><p><em>pandas Dataframe</em> – The absolute values used to plot the data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="plot-residuals">
<h2>Plot residuals<a class="headerlink" href="#plot-residuals" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.residuals">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.residuals" title="Permalink to this definition">#</a></dt>
<dd><p>Gets the residuals from system and plots them against the titrate
concentrations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>system</strong> (<em>System object</em>) – The system to plot the residuals for.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Matplotlib plot</em> – Scatterplot displaying the residuals between model prediction and
measured values.</p></li>
<li><p><em>pandas.dataframe</em> – Dataframe containing the numbers plotted.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="automated-input-outlier-detection">
<h2>Automated input outlier detection<a class="headerlink" href="#automated-input-outlier-detection" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="src.post_process.outlier">
<span class="sig-prename descclassname"><span class="pre">src.post_process.</span></span><span class="sig-name descname"><span class="pre">outlier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.post_process.outlier" title="Permalink to this definition">#</a></dt>
<dd><p>Uses a doornbos procedure to detect outliers in data associated with
system.
Will only detect suspects, removal needs to be performed manually after
conformation.
See src.analysis.outliers for details on the method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> (<em>system object</em>) – The system to analyse for outliers.</p></li>
<li><p><strong>write_output</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – Optional flag for directing the output to a file instead of system.out.
The default is False.</p></li>
<li><p><strong>skip_warnings</strong> (<em>Boolean</em><em>, </em><em>optional</em>) – Optional flag to not print warnings. The default is false.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Prints any outliers found to the system.out or to file depending
on parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Geertjens, Nick H.J.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Analysis methods overview</a><ul>
<li><a class="reference internal" href="#plot-system-data">Plot system data</a></li>
<li><a class="reference internal" href="#plotting-concentrations-graph">Plotting concentrations graph</a></li>
<li><a class="reference internal" href="#alternative-range-of-initial-guess-values-solver">Alternative range of initial guess values solver</a></li>
<li><a class="reference internal" href="#mean-squared-error-landscape">Mean squared error landscape</a><ul>
<li><a class="reference internal" href="#d-landscape">1D landscape</a></li>
<li><a class="reference internal" href="#id1">2D landscape</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameter-confidence-intervals">Parameter confidence intervals</a></li>
<li><a class="reference internal" href="#parameter-sensitivity-analysis">Parameter sensitivity analysis</a></li>
<li><a class="reference internal" href="#plot-residuals">Plot residuals</a></li>
<li><a class="reference internal" href="#automated-input-outlier-detection">Automated input outlier detection</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>